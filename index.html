<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>羽田空港待機所カメラ</title>
    <style>
        body {
            font-family: sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh; /* ビューポートの高さに合わせる */
            overflow: hidden; /* スクロールバーが出ないようにする */
        }

        h1 {
            margin: 10px 0; /* ヘッダーのマージンを減らす */
            font-size: 1.5em; /* フォントサイズも調整 */
            flex-shrink: 0; /* ヘッダーが縮まないようにする */
        }

        .camera-section {
            flex: 1; /* 利用可能なスペースを均等に分割 */
            display: flex;
            flex-direction: column; /* セクション内の要素を縦に並べる */
            justify-content: flex-start; /* 上揃え */
            align-items: center; /* 水平方向中央揃え */
            margin: 0;
            padding: 5px;
            border-bottom: 1px solid #eee; /* 各セクションの区切り */
            box-sizing: border-box;
            min-height: 0; /* flexアイテムが内容物によって大きくなりすぎないように */
            overflow: hidden; /* セクション内でスクロールしないようにする */
        }

        .camera-section:last-child {
            border-bottom: none;
        }

        .camera-section h2 {
            margin: 5px 0; /* タイトルのマージンを減らす */
            font-size: 1em;
            flex-shrink: 0; /* タイトルが縮まないようにする */
        }

        .camera-section img {
            width: 100%; /* 親要素の幅に合わせる */
            height: 100%; /* 親要素の高さに合わせる */
            object-fit: contain; /* アスペクト比を維持しつつ、要素内に収める */
            margin: 0;
        }

        .camera-section.horizontal {
            flex-direction: row; /* 横並びにする */
            justify-content: space-around; /* 均等に配置 */
            align-items: center;
        }

        .camera-section.horizontal img {
            width: 48%; /* 2つの画像を横並びにするため */
            height: 100%; /* 親要素の高さに合わせる */
            object-fit: contain;
            flex-grow: 0;
            flex-shrink: 0;
        }

        #flight-info-display {
            width: 100%;
            height: 100%; /* Take available height within its parent camera-section */
            overflow-y: auto; /* Allow scrolling if content overflows vertically */
            text-align: left; /* Flight info is usually left-aligned */
            padding: 5px;
            box-sizing: border-box;
            font-size: 0.8em; /* フォントサイズを小さくして多くの情報を表示 */
        }
    </style>
</head>
<body>
    <h1>羽田空港 待機所・乗り場ライブカメラ</h1>

    <div class="camera-section">
        <h2>第1待機所 南側</h2>
        <img id="camera01" src="https://ttc.taxi-inf.jp/Real01.jpg" alt="第1待機所 南側">
    </div>

    <div class="camera-section">
        <h2>第1待機所 東側</h2>
        <img id="camera02" src="https://ttc.taxi-inf.jp/Real02.jpg" alt="第1待機所 東側">
    </div>

    <div class="camera-section">
        <h2>第3待機所</h2>
        <img id="camera03" src="https://ttc.taxi-inf.jp/Real03.jpg" alt="第3待機所">
    </div>

    <div class="camera-section">
        <h2>第4待機所</h2>
        <img id="camera04" src="https://ttc.taxi-inf.jp/Real04.jpg" alt="第4待機所">
    </div>

    <div class="camera-section horizontal">
        <h2>第4乗場</h2>
        <img id="camera104" src="https://ttc.taxi-inf.jp/Real104_line.jpg" alt="第4乗場 左">
        <img id="camera105" src="https://ttc.taxi-inf.jp/Real105_line.jpg" alt="第4乗場 右">
    </div>

    <div class="camera-section">
        <h2>国内線到着状況</h2>
        <div id="flight-info-display">
            読み込み中...
        </div>
    </div>

    <script>
        function updateImage(id, baseUrl) {
            const imgElement = document.getElementById(id);
            if (imgElement) {
                // キャッシュを回避するためにタイムスタンプを追加
                imgElement.src = baseUrl + '?' + new Date().getTime();
            }
        }

        // 10秒ごとに画像を更新
        setInterval(() => {
            updateImage('camera01', 'https://ttc.taxi-inf.jp/Real01.jpg');
            updateImage('camera02', 'https://ttc.taxi-inf.jp/Real02.jpg');
            updateImage('camera03', 'https://ttc.taxi-inf.jp/Real03.jpg');
            updateImage('camera04', 'https://ttc.taxi-inf.jp/Real04.jpg');
            updateImage('camera104', 'https://ttc.taxi-inf.jp/Real104_line.jpg');
            updateImage('camera105', 'https://ttc.taxi-inf.jp/Real105_line.jpg');
        }, 10000); // 10000ミリ秒 = 10秒

        async function fetchFlightInfo() {
            const flightInfoDisplay = document.getElementById('flight-info-display');
            flightInfoDisplay.textContent = '読み込み中...'; // Reset loading message

            try {
                const response = await fetch('https://tokyo-haneda.com/flight/flightInfo_dms.html');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const html = await response.text();

                // ここでHTMLをパースして必要な情報を抽出します。
                // 現時点ではHTML構造が不明なため、取得したHTML全体をそのまま表示します。
                // 実際のHTML構造に合わせて、DOMParserなどを使って必要な要素を抽出してください。
                // 例: 特定のIDを持つdivの内容を抽出する場合
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const targetElement = doc.querySelector('.flight_list_area'); // 仮のセレクタ
                if (targetElement) {
                    flightInfoDisplay.innerHTML = targetElement.innerHTML;
                } else {
                    flightInfoDisplay.textContent = 'フライト情報が見つかりませんでした。HTML構造を確認してください。';
                }

            } catch (error) {
                console.error('フライト情報の取得中にエラーが発生しました:', error);
                flightInfoDisplay.textContent = 'フライト情報の取得に失敗しました。クロスオリジン制約やHTML構造の変更が原因の可能性があります。';
            }
        }

        // ページ読み込み時にフライト情報を取得
        fetchFlightInfo();

        // 1分ごとにフライト情報を更新
        setInterval(fetchFlightInfo, 60000); // 60000ミリ秒 = 1分
    </script>
</body>
</html>